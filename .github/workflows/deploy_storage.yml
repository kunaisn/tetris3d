name: Deploy to GCP Storage
run-name: ${{ github.actor }} is testing out GitHub Actions ğŸš€
on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: GCPã®æº–å‚™
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCP_KEY }}
        
      - name: GCPã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆJSONã‚­ãƒ¼ã‚’ç”Ÿæˆ
        run: echo "${{ secrets.GCP_KEY_BASE64 }}" | base64 -d > tmp.json
        
      - name: GCPã«èªè¨¼ã‚’é€šã™
        run: gcloud auth activate-service-account --key-file=tmp.json
        
      - name: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        run: gsutil -m rsync -r -d ./game/ ${{ secrets.GCS_BUCKET_PATH }}
        
      - name: JSONã‚­ãƒ¼ã‚’å‰Šé™¤
        run : rm -f tmp.json
